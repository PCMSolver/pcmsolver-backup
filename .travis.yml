language: cpp
sudo: false
dist: trusty
env:
  global:
   # The next declaration is the encrypted COVERITY_SCAN_TOKEN, created
   #   via the "travis encrypt" command using the project repo's public key
   - secure: "i/Rf+zE11b6EBbrr/vx5tiQc0FNbVO8Jz4bBUjxvJMy2YROPewN2GvHSHoLaEuz5+kD5gRF3MdTv+D3boOkYIJR32Y4T5IOlobA9dDUqGbMUae261uYfFbc05Dep+ZzWvNhQwn08zWJR/tYsgToFDeqcX+jUzIFOXat8qMLYBmfMwQ/B4nWWX775DsZ0v1fqrxGlpS0S2gHPEOWeULthRKII7t3rtM/lfnpSSN/cvsNvHPEn0lUwK9R1XJmij7Td6XJ+nFozIXN6HIP54cOfZBH7mGP+DyLokgoxAYFyr6e5d8FkgL4CefcAPWBRNPat44E7h+H40BFZlsTE8Z/CVwqfcwol7Hfu6abBIGHmXh/LJ411wIh8JFWHkqRCyxgHqE68UF+YZyC0Mk8ERnEcVGR4QagBYrHNiM6oFO2bMw5lIlXVgPbhwjCvfXDSIkvriWz6SB+nJbvEBlGuqnI+RfW4o5DCrTAY7+SwWQqux6PiDhulhQdoKHVUzOKonIVmXtB+HQWF8iW/QvQ+YV5JErcxi4faS2FLv9ftbf2nTwVHVUFURsQrC4bsnbX5Jky7AvJHVoxKXIkfsfXi1mAwVDFzKa1IzQvaq2EP29pleHk7AHlrhvc/K6kXFjeQjTcZ+urxkx4UmDWCslu6TAiiGzNemd3oEx3ddXabZQ4VHl0="
before_install:
  - test -n $CC && unset CC
  - test -n $CXX && unset CXX
  - test -n $FC && unset FC
  - echo -n | openssl s_client -connect https://scan.coverity.com:443 | sed -ne '/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p' | sudo tee -a /etc/ssl/certs/ca-
addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
    packages:
      - cmake3
      - g++-7
      - gcc-7
      - gfortran-7
      - libboost-math-dev
  coverity_scan:
    project:
      name: "PCMSolver/pcmsolver"
      description: "An API for the Polarizable Continuum Model"
    notification_email: roberto.diremigio@gmail.com
    build_command_prepend: "python setup.py --cxx=g++-7 --cc=gcc-7 --fc=gfortran-7 --type=debug --ccache=off --cmake-options='-DENABLE_TESTS=OFF -DENABLE_Fortran_API=ON'"
    build_command: "cmake --build build -- VERBOSE=1 -j 2"
    branch_pattern: coverity_scan
script:
  - cmake --build build -- VERBOSE=1 -j 2
